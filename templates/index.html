<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Map</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
        integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
        crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
        integrity="sha384-TZRcqFdN2T0H2tDBr1fN2QFvVrKGWxTCpJkUtEo/EYgp0MbJmKb1X9dXKj5oJOkS"
        crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js"></script>
    {{ mymap.style }}
</head>
<body>
    <nav class="navbar navbar-default">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                    data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">Map</a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <form class="navbar-form navbar-left">
                    <div class="form-group">
                        <input type="text" id="search" placeholder="Search" class="form-control">
                    </div>
                    <button type="button" class="btn btn-default" id="search-btn">Submit</button>
                </form>
            </div>
        </div>
    </nav>
    <div id="map" style="width: 100%; height: 90vh;">{{ mymap|safe }} </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
        integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
        crossorigin="anonymous"></script>
    {{ mymap.script }}
    <script>
    

$('#search-btn').click(function () {
    var search = $('#search').val();
    var mymap = L.map('map').setView([37.5665, 126.9780], 13);
    console.log($('#search').val())
    $.ajax({
        url: 'https://dapi.kakao.com/v2/local/search/address.json?query=' + search,
    type: "GET",
    headers: {
        "Authorization": "KakaoAK 13e47c09a28f2ac521ceb8012746862f"
    },
    dataType: 'json',
    success: function (data) {
        if (data['documents'].length > 0) {
            var lat = data['documents'][0]['y'];
            var lng = data['documents'][0]['x'];
            var name = data['documents'][0]['address_name'];
            var popup_text = '<b>' + name + '</b>';
            L.marker([lat, lng]).addTo(mymap).bindPopup(popup_text)
        } else {
            alert('No results found.');
        }
    },
    error: function () {
        alert('Error occurred while searching.');
    }
});
});
</script>
</body>

</html>
